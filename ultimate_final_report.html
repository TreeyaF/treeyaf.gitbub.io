<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»ˆæç‰ˆå–å®¶åˆ†ææŠ¥å‘Š - Fenghai</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1600px; margin: 0 auto; padding: 40px 20px; background: white; box-shadow: 0 0 30px rgba(0,0,0,0.1); border-radius: 15px; margin-top: 20px; margin-bottom: 20px; }
        .header { text-align: center; margin-bottom: 40px; padding: 30px 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 15px; margin: -20px -20px 40px -20px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2rem; opacity: 0.9; }
        .section { margin-bottom: 30px; padding: 25px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #667eea; }
        .section h2 { color: #667eea; font-size: 1.8rem; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #e9ecef; }
        .stat-number { font-size: 2rem; font-weight: bold; margin-bottom: 5px; color: white; }
        .stat-label { color: white; font-size: 0.9rem; }
        
        /* ç»Ÿä¸€ç™½è‰²æ–‡å­—çš„é¢œè‰²æ–¹æ¡ˆ */
        .revenue-card { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
            color: white; 
            border: 2px solid #059669;
        }
        .expense-card { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; 
            border: 2px solid #dc2626;
        }
        .transfer-card { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); 
            color: white; 
            border: 2px solid #d97706;
        }
        .profit-card { 
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); 
            color: white; 
            border: 2px solid #2563eb;
        }
        .info-card {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: 2px solid #7c3aed;
        }
        
        /* æ ‡ç­¾é¡µæ ·å¼ */
        .tab-container { margin: 20px 0; }
        .tab-buttons { display: flex; background: #f8f9fa; border-radius: 10px 10px 0 0; overflow: hidden; }
        .tab-button { flex: 1; padding: 15px 20px; background: #e9ecef; border: none; cursor: pointer; font-size: 16px; font-weight: 600; color: #6c757d; transition: all 0.3s; }
        .tab-button.active { background: #667eea; color: white; }
        .tab-button:hover { background: #495057; color: white; }
        .tab-content { display: none; background: white; padding: 25px; border-radius: 0 0 10px 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .tab-content.active { display: block; }
        
        .chart-section { background: white; padding: 25px; border-radius: 10px; margin: 20px 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .chart-controls { margin-bottom: 20px; text-align: center; }
        .checkbox-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 15px 0; }
        .checkbox-item { display: flex; align-items: center; gap: 8px; }
        .checkbox-item input[type="checkbox"] { transform: scale(1.2); }
        
        /* æ”¯å‡ºåˆ†ææ ·å¼ */
        .expense-controls { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .control-group { margin-bottom: 15px; }
        .control-group label { font-weight: 600; color: #495057; margin-bottom: 8px; display: block; }
        .control-group select { padding: 8px 12px; border: 1px solid #ced4da; border-radius: 5px; font-size: 14px; }
        .expense-checkboxes { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 10px; }
        .expense-checkboxes label { display: flex; align-items: center; gap: 8px; font-weight: normal; margin-bottom: 5px; }
        .expense-checkboxes input[type="checkbox"] { transform: scale(1.1); }
        .control-buttons { margin-top: 15px; }
        .control-buttons button { padding: 8px 16px; margin: 0 5px; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .control-buttons button:first-child { background: #28a745; color: white; }
        .control-buttons button:nth-child(2) { background: #dc3545; color: white; }
        .control-buttons button:last-child { background: #007bff; color: white; }
        .control-buttons button:hover { opacity: 0.8; transform: translateY(-1px); }
        .insights-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .insight-card { background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #667eea; }
        .insight-card h4 { color: #667eea; margin-bottom: 15px; }
        .insight-card ul { list-style: none; padding: 0; }
        .insight-card li { margin-bottom: 8px; padding-left: 20px; position: relative; }
        .insight-card li:before { content: "â–¶"; position: absolute; left: 0; color: #667eea; }
        .checkbox-item label { cursor: pointer; font-size: 14px; }
        .control-buttons { margin: 15px 0; text-align: center; }
        .btn { padding: 8px 16px; margin: 0 5px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn:hover { opacity: 0.8; }
        
        .chart-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .chart-item { background: #f8f9fa; padding: 20px; border-radius: 10px; }
        .chart-item h3 { color: #667eea; margin-bottom: 15px; text-align: center; }
        .chart-container { position: relative; height: 300px; }
        
        .data-table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-size: 0.75rem; }
        .data-table th, .data-table td { padding: 4px 2px; text-align: center; border-bottom: 1px solid #e9ecef; border-right: 1px solid #e9ecef; }
        .data-table th { background: #667eea; color: white; font-weight: 600; position: sticky; top: 0; }
        .data-table .row-header { background: #f8f9fa; font-weight: bold; text-align: left; padding-left: 4px; position: sticky; left: 0; z-index: 1; min-width: 100px; font-size: 0.7rem; }
        .data-table .total-row { background: #ffe6e6; font-weight: bold; color: #d63384; }
        .data-table .total-col { background: #fff3cd; font-weight: bold; color: #856404; }
        
        /* æ”¯å‡ºè¡¨æ ¼ä¸“ç”¨æ ·å¼ - çº¢æ©™é»„è‰²ç³» */
        .expense-table { }
        .expense-table th { background: #dc3545; color: white; font-weight: 600; position: sticky; top: 0; }
        .expense-table .row-header { background: #fff5f5; font-weight: bold; text-align: left; padding-left: 4px; position: sticky; left: 0; z-index: 1; min-width: 100px; font-size: 0.7rem; color: #721c24; }
        .expense-table .total-row { background: #ffebee; font-weight: bold; color: #c62828; }
        .expense-table .total-col { background: #fff3e0; font-weight: bold; color: #e65100; }
        .expense-table tr:hover { background: #ffeaa7; }
        .expense-table td { color: #d63384; }
        
        /* ASINé”€é‡è¡¨æ ¼ä¸“ç”¨æ ·å¼ - æµ…ç»¿è‰²æ€»è®¡ */
        .asin-table .total-row { background: #e8f5e8; font-weight: bold; color: #2e7d32; }
        .asin-table .total-col { background: #e8f5e8; font-weight: bold; color: #2e7d32; }
        
        /* è´¢åŠ¡æ±‡æ€»è¡¨æ ¼ä¸“ç”¨æ ·å¼ - è“è‰²ç³» */
        .financial-summary-table { }
        .financial-summary-table th { background: #007bff; color: white; font-weight: 600; position: sticky; top: 0; }
        .financial-summary-table .row-header { background: #f0f8ff; font-weight: bold; text-align: left; padding-left: 4px; position: sticky; left: 0; z-index: 1; min-width: 100px; font-size: 0.7rem; color: #0056b3; }
        .financial-summary-table .total-row { background: #e3f2fd; font-weight: bold; color: #1565c0; }
        .financial-summary-table .total-col { background: #e3f2fd; font-weight: bold; color: #1565c0; }
        .financial-summary-table tr:hover { background: #f0f8ff; }
        .financial-summary-table .positive-profit { color: #28a745; font-weight: bold; }
        .financial-summary-table .negative-profit { color: #dc3545; font-weight: bold; }
        .financial-summary-table .income-cell { color: #28a745; }
        .financial-summary-table .expense-cell { color: #dc3545; }
        .data-table tr:hover { background: #f0f8ff; }
        .table-container { overflow: auto; margin: 20px 0; max-height: 600px; border: 1px solid #ddd; border-radius: 10px; }
        .highlight-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .avg-price { color: #666; font-size: 0.6rem; }
        
        @media (max-width: 768px) { 
            .chart-grid { grid-template-columns: 1fr; }
            .data-table { font-size: 0.65rem; } 
            .data-table th, .data-table td { padding: 2px 1px; } 
            .checkbox-container { grid-template-columns: 1fr; }
            .expense-checkboxes { grid-template-columns: 1fr; }
            .insights-grid { grid-template-columns: 1fr; }
            .tab-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ç»ˆæç‰ˆå–å®¶åˆ†ææŠ¥å‘Š</h1>
            <p>Fenghai - Amazoné”€å”®æ•°æ®å®Œæ•´åˆ†æ (2024å¹´6æœˆ - 2025å¹´6æœˆ)</p>
        </div>

        <div class="section">
            <h2>ğŸ“ˆ è´¢åŠ¡æ¦‚è§ˆ</h2>
            <div class="stats-grid">
                <div class="stat-card revenue-card">
                    <div class="stat-number">$165,569</div>
                    <div class="stat-label">æ€»æ”¶å…¥</div>
                </div>
                <div class="stat-card expense-card">
                    <div class="stat-number">-$90,795</div>
                    <div class="stat-label">å‡€è´¹ç”¨</div>
                </div>
                <div class="stat-card transfer-card">
                    <div class="stat-number">$71,731</div>
                    <div class="stat-label">è½¬è´¦æ”¶å…¥</div>
                </div>
                <div class="stat-card profit-card">
                    <div class="stat-number">$74,774</div>
                    <div class="stat-label">å‡€åˆ©æ¶¦</div>
                </div>
                <div class="stat-card info-card">
                    <div class="stat-number">45.2%</div>
                    <div class="stat-label">åˆ©æ¶¦ç‡</div>
                </div>
                <div class="stat-card info-card">
                    <div class="stat-number">8,646</div>
                    <div class="stat-label">è®¢å•æ€»æ•°</div>
                </div>
            </div>
        </div>

        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('overview')">ğŸ“Š æ€»è§ˆåˆ†æ</button>
                <button class="tab-button" onclick="switchTab('comparison')">ğŸ” ASINå¯¹æ¯”</button>
                <button class="tab-button" onclick="switchTab('expenses')">ğŸ’° å…¶ä»–è´¹ç”¨</button>
            </div>
            
            <div id="overview" class="tab-content active">
                <div class="section">
                    <h2>ğŸ“ˆ æœˆåº¦è´¢åŠ¡è¶‹åŠ¿</h2>
                    <div class="chart-grid">
                        <div class="chart-item">
                            <h3>æœˆåº¦æ”¶å…¥ä¸æ”¯å‡º</h3>
                            <div class="chart-container">
                                <canvas id="monthlyFinanceChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-item">
                            <h3>å‡€åˆ©æ¶¦ä¸åˆ©æ¶¦ç‡</h3>
                            <div class="chart-container">
                                <canvas id="profitChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æœˆåº¦è´¢åŠ¡æ±‡æ€»è¡¨æ ¼ -->
                    <div class="highlight-box" style="margin-top: 30px;">
                        <h3>ğŸ“Š æœˆåº¦è´¢åŠ¡æ±‡æ€»è¡¨</h3>
                        <p>è¯¦ç»†å±•ç¤ºæ¯ä¸ªæœˆçš„æ”¶å…¥ã€æ”¯å‡ºã€å‡€åˆ©æ¶¦å’Œåˆ©æ¶¦ç‡</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table financial-summary-table" id="financialSummaryTable">
                            <!-- è¡¨æ ¼å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </table>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ›ï¸ ASINé”€é‡è¯¦ç»†ç»Ÿè®¡</h2>
                    <div class="highlight-box">
                        <h3>ğŸ“‹ æ‰€æœ‰ASINæœˆåº¦é”€é‡ç»Ÿè®¡ï¼ˆåƒä½åˆ†éš”æ ¼å¼ï¼‰</h3>
                        <p>æ¯ä¸ªå•å…ƒæ ¼æ˜¾ç¤ºï¼šæ•°é‡ / $é‡‘é¢ / $å¹³å‡ä»·æ ¼</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table" id="asinTable">
                            <!-- è¡¨æ ¼å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </table>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ’° æ”¯å‡ºç±»å‹è¯¦ç»†åˆ†æ</h2>
                    <div class="highlight-box">
                        <h3>ğŸ“‹ å„ç±»å‹æ”¯å‡ºæœˆåº¦åˆ†è§£ï¼ˆåƒä½åˆ†éš”æ ¼å¼ï¼‰</h3>
                        <p>æ¨ªè½´ä¸ºæœˆä»½ï¼Œçºµè½´ä¸ºæ”¯å‡ºç±»å‹ï¼Œæ¯ä¸ªå•å…ƒæ ¼æ˜¾ç¤ºè¯¥æœˆè¯¥ç±»å‹çš„æ”¯å‡ºé‡‘é¢</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table" id="expenseTable">
                            <!-- è¡¨æ ¼å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </table>
                    </div>
                </div>
            </div>
            
            <div id="comparison" class="tab-content">
                <div class="section">
                    <h2>ğŸ“Š å¤šé€‰ASINå¯¹æ¯”åˆ†æ</h2>
                    <div class="highlight-box">
                        <h3>ğŸ¯ å¤šäº§å“å¯¹æ¯”åˆ†æå·¥å…·</h3>
                        <p>å¯ä»¥åŒæ—¶é€‰æ‹©å¤šä¸ªASINè¿›è¡Œå¯¹æ¯”åˆ†æï¼Œåœ¨åŒä¸€ä¸ªå›¾è¡¨ä¸­æŸ¥çœ‹ä¸åŒäº§å“çš„è¡¨ç°å·®å¼‚ã€‚</p>
                    </div>
                    
                    <div class="chart-section">
                        <div class="chart-controls">
                            <h4 style="margin-bottom: 15px;">é€‰æ‹©è¦å¯¹æ¯”çš„ASIN:</h4>
                            <div class="checkbox-container">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0CC2TZFCL" value="B0CC2TZFCL" checked>
                                    <label for="asin_B0CC2TZFCL">B0CC2TZFCL</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0D6X54QJF" value="B0D6X54QJF" checked>
                                    <label for="asin_B0D6X54QJF">B0D6X54QJF</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0D6ZWNB9B" value="B0D6ZWNB9B" checked>
                                    <label for="asin_B0D6ZWNB9B">B0D6ZWNB9B</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0D77YR4W4" value="B0D77YR4W4">
                                    <label for="asin_B0D77YR4W4">B0D77YR4W4</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0D9DLFP7S" value="B0D9DLFP7S">
                                    <label for="asin_B0D9DLFP7S">B0D9DLFP7S</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0D9FRNZQB" value="B0D9FRNZQB">
                                    <label for="asin_B0D9FRNZQB">B0D9FRNZQB</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0DC15BLGH" value="B0DC15BLGH">
                                    <label for="asin_B0DC15BLGH">B0DC15BLGH</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0DC15DT9B" value="B0DC15DT9B">
                                    <label for="asin_B0DC15DT9B">B0DC15DT9B</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0DC6WX9WH" value="B0DC6WX9WH">
                                    <label for="asin_B0DC6WX9WH">B0DC6WX9WH</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="asin_B0F3VTWL5W" value="B0F3VTWL5W">
                                    <label for="asin_B0F3VTWL5W">B0F3VTWL5W</label>
                                </div>
                            </div>
                            <div class="control-buttons">
                                <button class="btn btn-primary" onclick="selectAll()">å…¨é€‰</button>
                                <button class="btn btn-secondary" onclick="clearAll()">æ¸…ç©º</button>
                                <button class="btn btn-primary" onclick="selectTop3()">é€‰æ‹©å‰3å</button>
                                <button class="btn btn-primary" onclick="updateComparisonCharts()">æ›´æ–°å›¾è¡¨</button>
                            </div>
                        </div>
                        
                        <div class="chart-grid">
                            <div class="chart-item">
                                <h3>å¤šASINé”€é‡å¯¹æ¯”</h3>
                                <div class="chart-container">
                                    <canvas id="quantityChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-item">
                                <h3>å¤šASINé”€å”®é‡‘é¢å¯¹æ¯”</h3>
                                <div class="chart-container">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-grid">
                            <div class="chart-item">
                                <h3>å¤šASINå¹³å‡ä»·æ ¼å¯¹æ¯”</h3>
                                <div class="chart-container">
                                    <canvas id="priceChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-item">
                                <h3>é€‰ä¸­ASINæ€»é”€é‡åˆ†å¸ƒ</h3>
                                <div class="chart-container">
                                    <canvas id="distributionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ”¯å‡ºåˆ†ææ ‡ç­¾é¡µ -->
        <div id="expenses" class="tab-content">
            <div class="section">
                <h2>ğŸ’° å…¶ä»–è´¹ç”¨è¯¦æƒ…</h2>
                
                <!-- æ”¯å‡ºæ¦‚è§ˆå¡ç‰‡ -->
                <div class="overview-grid">
                    <div class="overview-card">
                        <div class="card-icon">ğŸ’¸</div>
                        <div class="card-content">
                            <h3>å‡€è´¹ç”¨æ€»è®¡</h3>
                            <div class="card-value">-$90,795</div>
                            <div class="card-subtitle">13ä¸ªæœˆç´¯è®¡</div>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“Š</div>
                        <div class="card-content">
                            <h3>å¹³å‡æœˆå‡€è´¹ç”¨</h3>
                            <div class="card-value">-$6,984</div>
                            <div class="card-subtitle">æœˆåº¦å¹³å‡å€¼</div>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“ˆ</div>
                        <div class="card-content">
                            <h3>æœ€é«˜æœˆå‡€è´¹ç”¨</h3>
                            <div class="card-value">-$27,940</div>
                            <div class="card-subtitle">2024å¹´12æœˆ</div>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon">ğŸ“‰</div>
                        <div class="card-content">
                            <h3>æœ€ä½æœˆå‡€è´¹ç”¨</h3>
                            <div class="card-value">-$266</div>
                            <div class="card-subtitle">2024å¹´6æœˆ</div>
                        </div>
                    </div>
                </div>

                <!-- æ”¯å‡ºç±»å‹é€‰æ‹©å™¨ -->
                <div class="chart-section">
                    <h3>ğŸ¯ æ”¯å‡ºç±»å‹åˆ†æ</h3>
                    <div class="expense-controls">
                        <div class="control-group">
                            <label>é€‰æ‹©åˆ†æç»´åº¦ï¼š</label>
                            <select id="expenseViewType" onchange="updateExpenseView()">
                                <option value="total">æ€»ä½“å æ¯”åˆ†æ</option>
                                <option value="monthly">æœˆåº¦è¶‹åŠ¿åˆ†æ</option>
                                <option value="comparison">ç±»å‹å¯¹æ¯”åˆ†æ</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>æ”¯å‡ºç±»å‹ç­›é€‰ï¼š</label>
                            <div class="expense-checkboxes">
                                <label><input type="checkbox" value="Service Fee" checked onchange="updateExpenseCharts()"> Service Fee (æœåŠ¡è´¹)</label>
                                <label><input type="checkbox" value="Refund" checked onchange="updateExpenseCharts()"> Refund (é€€æ¬¾)</label>
                                <label><input type="checkbox" value="FBA Inventory Fee" checked onchange="updateExpenseCharts()"> FBA Inventory Fee (åº“å­˜è´¹)</label>
                                <label><input type="checkbox" value="Adjustment" checked onchange="updateExpenseCharts()"> Adjustment (è°ƒæ•´)</label>
                                <label><input type="checkbox" value="FBA Transaction fees" checked onchange="updateExpenseCharts()"> FBA Transaction fees (äº¤æ˜“è´¹)</label>
                                <label><input type="checkbox" value="Liquidations" checked onchange="updateExpenseCharts()"> Liquidations (æ¸…ç®—)</label>
                            </div>
                        </div>
                        <div class="control-buttons">
                            <button onclick="selectAllExpenses()">å…¨é€‰</button>
                            <button onclick="clearAllExpenses()">æ¸…ç©º</button>
                            <button onclick="selectTopExpenses()">é€‰æ‹©ä¸»è¦æ”¯å‡º</button>
                        </div>
                    </div>
                </div>

                <!-- å›¾è¡¨åŒºåŸŸ -->
                <div class="chart-grid">
                    <div class="chart-item">
                        <h3 id="expenseChartTitle">æ”¯å‡ºç±»å‹æ€»ä½“å æ¯”</h3>
                        <div class="chart-container">
                            <canvas id="expenseMainChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-item">
                        <h3>æ”¯å‡ºç±»å‹æœˆåº¦è¶‹åŠ¿</h3>
                        <div class="chart-container">
                            <canvas id="expenseTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- è¯¦ç»†æ”¯å‡ºç»Ÿè®¡è¡¨ -->
                <div class="chart-section">
                    <h3>ğŸ“‹ è¯¦ç»†æ”¯å‡ºç»Ÿè®¡è¡¨</h3>
                    <div class="table-container">
                        <table id="detailedExpenseTable" class="data-table">
                            <!-- è¡¨æ ¼å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </table>
                    </div>
                </div>

                <!-- æ”¯å‡ºæ´å¯Ÿåˆ†æ -->
                <div class="chart-section">
                    <h3>ğŸ” æ”¯å‡ºæ´å¯Ÿåˆ†æ</h3>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <h4>ğŸ’¡ ä¸»è¦è´¹ç”¨ç±»å‹</h4>
                            <ul>
                                <li><strong>Service Fee</strong>: -$73,126 (80.5%) - å¹³å°æœåŠ¡è´¹æ˜¯æœ€å¤§æ”¯å‡ºé¡¹</li>
                                <li><strong>Refund</strong>: -$8,855 (9.8%) - é€€æ¬¾æŸå¤±éœ€è¦å…³æ³¨</li>
                                <li><strong>FBA Inventory Fee</strong>: -$8,166 (9.0%) - åº“å­˜ç®¡ç†è´¹ç”¨</li>
                                <li><strong>BLANK</strong>: -$1,750 (1.9%) - å…¶ä»–æœªåˆ†ç±»è´¹ç”¨</li>
                                <li><strong>Adjustment</strong>: +$987 (æ”¶å…¥è°ƒæ•´) - æ­£å‘è°ƒæ•´</li>
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>ğŸ“ˆ è´¹ç”¨è¶‹åŠ¿åˆ†æ</h4>
                            <ul>
                                <li><strong>2024å¹´12æœˆ</strong>: å‡€è´¹ç”¨å³°å€¼æœˆä»½(-$27,940)ï¼Œä¸»è¦ç”±äºå¤§é‡å¹³å°è´¹ç”¨</li>
                                <li><strong>2025å¹´1-6æœˆ</strong>: å‡€è´¹ç”¨é€æ­¥ä¸‹é™ï¼Œè¿è¥æ•ˆç‡æå‡</li>
                                <li><strong>å¹³å‡æœˆå‡€è´¹ç”¨</strong>: -$6,984ï¼Œæˆæœ¬æ§åˆ¶è‰¯å¥½</li>
                                <li><strong>BLANKè´¹ç”¨</strong>: ä¸»è¦é›†ä¸­åœ¨2025å¹´4-6æœˆ</li>
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>âš ï¸ æˆæœ¬ä¼˜åŒ–å»ºè®®</h4>
                            <ul>
                                <li><strong>å¹³å°è´¹ç”¨</strong>: ä¼˜åŒ–é”€å”®ç­–ç•¥ï¼Œæé«˜å•ä»·é™ä½è´¹ç‡å½±å“</li>
                                <li><strong>é€€æ¬¾ç‡æ§åˆ¶</strong>: æå‡äº§å“è´¨é‡ï¼Œé™ä½é€€æ¬¾ç‡</li>
                                <li><strong>åº“å­˜ç®¡ç†</strong>: ä¼˜åŒ–FBAåº“å­˜ï¼Œå‡å°‘åº“å­˜è´¹ç”¨</li>
                                <li><strong>æœªåˆ†ç±»è´¹ç”¨</strong>: è¯†åˆ«BLANKè´¹ç”¨æ¥æºï¼ŒåŠ å¼ºè´¹ç”¨ç®¡ç†</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 25px; background: #f8f9fa; border-radius: 15px;">
            <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“‹ ç»ˆæç‰ˆæŠ¥å‘Šæ€»ç»“</h3>
            <p style="color: #6c757d; font-size: 1.1rem; line-height: 1.6;">
                è¯¥ç»ˆæç‰ˆæŠ¥å‘ŠåŒ…å«å®Œæ•´çš„è´¢åŠ¡åˆ†æã€ASINé”€é‡ç»Ÿè®¡å’Œè¯¦ç»†æ”¯å‡ºåˆ†è§£ã€‚
                æ”¯æŒæ ‡ç­¾é¡µåˆ‡æ¢ï¼Œæä¾›æ€»è§ˆåˆ†æã€ASINå¯¹æ¯”å’Œå…¶ä»–è´¹ç”¨ä¸‰ä¸ªè§†å›¾ã€‚
                æ‰€æœ‰æ•°å­—é‡‡ç”¨åƒä½åˆ†éš”æ ¼å¼ï¼Œç•Œé¢æ¸…æ™°ç¾è§‚ï¼Œæ”¯æŒäº¤äº’å¼æ•°æ®æ¢ç´¢ã€‚
            </p>
            <p style="color: #495057; font-weight: 600; margin-top: 15px;">
                åŠŸèƒ½å®Œæ•´ï¼Œæ•°æ®å‡†ç¡®ï¼Œç•Œé¢ä¼˜åŒ–ï¼Œä½“éªŒæä½³ï¼ğŸš€
            </p>
        </div>
    </div>

    <script>
        // æ•°æ®å®šä¹‰
        const months = ['2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', '2024-12', '2025-01', '2025-02', '2025-03', '2025-04', '2025-05', '2025-06'];
        
        const monthlyFinanceData = {
            income: [374, 3248, 2327, 3014, 4648, 19706, 71802, 10854, 12122, 9917, 10664, 8808, 8085],
            expenses: [-265.97, -624.9, -718.73, -707.42, -5298.61, -12352.9, -27940.33, -9421.7, -8523.82, -6552.76, -7044.34, -6378.56, -4964.48],
            transfers: [0, 1719, 1466, 2329, 0, 0, 66217, 0, 0, 0, 0, 0, 0],
            profit: [108.03, 2623.1, 1608.27, 2306.58, -650.61, 7353.1, 43861.67, 1432.3, 3598.18, 3364.24, 3619.66, 2429.44, 3120.52],
            profitRate: [28.9, 80.8, 69.1, 76.5, -14.0, 37.3, 61.1, 13.2, 29.7, 33.9, 33.9, 27.6, 38.6]
        };
        
        const asinData = {
            'B0CC2TZFCL': {
                quantities: [38, 249, 102, 100, 85, 214, 209, 11, 19, 22, 43, 54, 32],
                revenues: [374, 3248, 1678, 1483, 1189, 2930, 3403, 283, 513, 392, 828, 797, 480],
                prices: [9.84, 13.05, 16.45, 14.83, 13.99, 13.69, 16.28, 25.73, 27.00, 17.82, 19.26, 14.76, 15.00]
            },
            'B0D6X54QJF': {
                quantities: [0, 0, 0, 14, 49, 373, 1075, 154, 177, 118, 92, 79, 120],
                revenues: [0, 0, 0, 27, 1015, 7332, 24669, 3588, 4101, 2960, 2411, 1504, 1849],
                prices: [0, 0, 0, 1.93, 20.71, 19.65, 22.95, 23.30, 23.17, 25.08, 26.21, 19.04, 15.41]
            },
            'B0D6ZWNB9B': {
                quantities: [0, 0, 37, 52, 95, 208, 725, 69, 80, 98, 132, 113, 159],
                revenues: [0, 0, 618, 1177, 1923, 3975, 14963, 1738, 2453, 2640, 3323, 2901, 3779],
                prices: [0, 0, 16.70, 22.63, 20.24, 19.11, 20.64, 25.19, 30.66, 26.94, 25.17, 25.67, 23.77]
            },
            'B0D77YR4W4': {
                quantities: [0, 0, 1, 38, 15, 41, 315, 9, 87, 11, 3, 4, 4],
                revenues: [0, 0, 31, 311, 249, 557, 5659, 199, 839, 136, 95, 110, 101],
                prices: [0, 0, 31.00, 8.18, 16.60, 13.59, 17.97, 22.11, 9.64, 12.36, 31.67, 27.50, 25.25]
            },
            'B0D9DLFP7S': {
                quantities: [0, 0, 0, 3, 8, 33, 99, 96, 43, 54, 95, 3, 3],
                revenues: [0, 0, 0, 45, 121, 927, 2327, 1646, 1277, 782, 1429, 57, 110],
                prices: [0, 0, 0, 15.00, 15.13, 28.09, 23.51, 17.15, 29.70, 14.48, 15.04, 19.00, 36.67]
            },
            'B0D9FRNZQB': {
                quantities: [0, 0, 0, 3, 3, 20, 203, 123, 17, 32, 5, 4, 5],
                revenues: [0, 0, 0, -29, 61, 512, 4386, 1901, 580, 544, 158, 117, 174],
                prices: [0, 0, 0, -9.67, 20.33, 25.60, 21.61, 15.46, 34.12, 17.00, 31.60, 29.25, 34.80]
            },
            'B0DC15BLGH': {
                quantities: [0, 0, 0, 0, 1, 47, 164, 4, 7, 12, 15, 32, 10],
                revenues: [0, 0, 0, 0, 25, 906, 3349, 135, 217, 348, 408, 828, 273],
                prices: [0, 0, 0, 0, 25.00, 19.28, 20.42, 33.75, 31.00, 29.00, 27.20, 25.88, 27.30]
            },
            'B0DC15DT9B': {
                quantities: [0, 0, 0, 0, 7, 53, 152, 3, 8, 42, 46, 52, 32],
                revenues: [0, 0, 0, 0, 58, 962, 3006, 101, 259, 1149, 1124, 1288, 788],
                prices: [0, 0, 0, 0, 8.29, 18.15, 19.78, 33.67, 32.38, 27.36, 24.43, 24.77, 24.63]
            },
            'B0DC6WX9WH': {
                quantities: [0, 0, 0, 0, 8, 112, 667, 58, 148, 54, 59, 226, 41],
                revenues: [0, 0, 0, 0, 7, 1605, 10040, 1263, 1883, 968, 888, 1206, 598],
                prices: [0, 0, 0, 0, 0.88, 14.33, 15.05, 21.78, 12.72, 17.93, 15.05, 5.34, 14.59]
            },
            'B0F3VTWL5W': {
                quantities: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9],
                revenues: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -67],
                prices: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -7.44]
            }
        };

        const expenseData = {
            'Adjustment': [0, 14.87, 15.6, 22.01, 0.0, 102.62, 82.12, 176.61, 637.04, 266.3, -250.73, -41.06, -38.01],
            'FBA Inventory Fee': [0, -18.32, -71.22, -220.71, -352.83, -1771.52, -2809.48, -1441.54, -304.66, -358.56, -323.9, -287.62, -205.67],
            'FBA Transaction fees': [0, 0, 0, 0.0, 0.0, -9.46, 0, 0, -9.36, 0.0, -5.05, 0, -9.41],
            'Liquidations': [0, 0, 0, 0, 0, 3.05, 1.3, 5.82, 4.55, 16.05, 23.98, 62.18, 31.46],
            'Liquidations Adjustments': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'Order_Retrocharge': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            'Refund': [-21.7, -478.95, -281.71, -215.13, -188.11, -241.18, -2971.3, -2149.46, -565.65, -516.14, -478.64, -437.06, -309.63],
            'Service Fee': [-244.27, -142.5, -231.4, -143.59, -4707.67, -10436.41, -22242.97, -6013.13, -8285.74, -5960.41, -5810.0, -5075.0, -3833.22],
            'BLANK': [0, 0, -150.0, -150.0, -50.0, 0, 0, 0, 0, 0, -200.0, -600.0, -600.0]
        };

        // Transferæ•°æ®å•ç‹¬å¤„ç†ï¼ˆè¿™æ˜¯æ”¶å…¥ï¼Œä¸æ˜¯æ”¯å‡ºï¼‰
        const transferData = [0, 1719, 1466, 2329, 0, 0, 66217, 0, 0, 0, 0, 0, 0];

        // é¢œè‰²é…ç½®
        const colors = [
            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
            '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#8B5CF6'
        ];

        // å›¾è¡¨å®ä¾‹
        let monthlyFinanceChart, profitChart, quantityChart, revenueChart, priceChart, distributionChart;
        let expenseMainChart, expenseTrendChart;

        // æ ¼å¼åŒ–æ•°å­—ä¸ºåƒä½åˆ†éš”æ ¼å¼ï¼Œä¿æŒåŸå§‹æ­£è´Ÿæ•°ï¼Œä¿ç•™1ä½å°æ•°
        function formatNumber(num) {
            if (num === 0) return '0.0';
            if (num === null || num === undefined) return '-';
            
            // ç¡®ä¿æ˜¯æ•°å­—ç±»å‹
            const numValue = typeof num === 'string' ? parseFloat(num) : num;
            if (isNaN(numValue)) return '-';
            
            // ä¿ç•™1ä½å°æ•°ï¼Œä¿æŒåŸå§‹æ­£è´Ÿå·
            return numValue.toLocaleString(undefined, {
                minimumFractionDigits: 1,
                maximumFractionDigits: 1
            });
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„æŒ‰é’®
            event.target.classList.add('active');
            
            // å¦‚æœåˆ‡æ¢åˆ°å¯¹æ¯”æ ‡ç­¾ï¼Œåˆå§‹åŒ–å¯¹æ¯”å›¾è¡¨
            if (tabName === 'comparison') {
                setTimeout(() => {
                    initComparisonCharts();
                }, 100);
            }
            
            // å¦‚æœåˆ‡æ¢åˆ°æ”¯å‡ºåˆ†ææ ‡ç­¾ï¼Œåˆå§‹åŒ–æ”¯å‡ºå›¾è¡¨
            if (tabName === 'expenses') {
                setTimeout(() => {
                    initExpenseCharts();
                    generateDetailedExpenseTable();
                }, 100);
            }
        }

        // ç”ŸæˆASINè¡¨æ ¼
        function generateAsinTable() {
            const table = document.getElementById('asinTable');
            table.className = 'data-table asin-table'; // æ·»åŠ ASINä¸“ç”¨æ ·å¼ç±»
            let html = '<thead><tr><th class="row-header">ASIN</th>';
            
            // æ·»åŠ æœˆä»½åˆ—æ ‡é¢˜
            months.forEach(month => {
                html += `<th>${month}</th>`;
            });
            html += '<th class="total-col">æ€»è®¡</th></tr></thead><tbody>';
            
            // æ·»åŠ æ¯ä¸ªASINçš„æ•°æ®è¡Œ
            Object.keys(asinData).forEach(asin => {
                html += `<tr><td class="row-header">${asin}</td>`;
                
                months.forEach((month, index) => {
                    const qty = asinData[asin].quantities[index];
                    const revenue = asinData[asin].revenues[index];
                    const price = asinData[asin].prices[index];
                    
                    if (qty === 0) {
                        html += '<td>0 / $0.0<br><span class="avg-price">-</span></td>';
                    } else {
                        html += `<td>${formatNumber(qty)} / $${formatNumber(revenue)}<br><span class="avg-price">$${price.toFixed(1)}</span></td>`;
                    }
                });
                
                // æ€»è®¡åˆ—
                const totalQty = asinData[asin].quantities.reduce((sum, qty) => sum + qty, 0);
                const totalRevenue = asinData[asin].revenues.reduce((sum, rev) => sum + rev, 0);
                const avgPrice = totalQty > 0 ? totalRevenue / totalQty : 0;
                
                html += `<td class="total-col"><strong>${formatNumber(totalQty)} / $${formatNumber(totalRevenue)}<br><span class="avg-price">$${avgPrice.toFixed(1)}</span></strong></td></tr>`;
            });
            
            // æ·»åŠ æ€»è®¡è¡Œ
            html += '<tr class="total-row"><td class="row-header"><strong>æœˆåº¦æ€»è®¡</strong></td>';
            months.forEach((month, index) => {
                const totalQty = Object.values(asinData).reduce((sum, asin) => sum + asin.quantities[index], 0);
                const totalRevenue = Object.values(asinData).reduce((sum, asin) => sum + asin.revenues[index], 0);
                const avgPrice = totalQty > 0 ? totalRevenue / totalQty : 0;
                
                html += `<td><strong>${formatNumber(totalQty)} / $${formatNumber(totalRevenue)}<br><span class="avg-price">$${avgPrice.toFixed(1)}</span></strong></td>`;
            });
            
            // æ€»çš„æ€»è®¡
            const grandTotalQty = Object.values(asinData).reduce((sum, asin) => 
                sum + asin.quantities.reduce((s, q) => s + q, 0), 0);
            const grandTotalRevenue = Object.values(asinData).reduce((sum, asin) => 
                sum + asin.revenues.reduce((s, r) => s + r, 0), 0);
            const grandAvgPrice = grandTotalQty > 0 ? grandTotalRevenue / grandTotalQty : 0;
            
            html += `<td class="total-col"><strong>${formatNumber(grandTotalQty)} / $${formatNumber(grandTotalRevenue)}<br><span class="avg-price">$${grandAvgPrice.toFixed(1)}</span></strong></td></tr>`;
            html += '</tbody>';
            
            table.innerHTML = html;
        }

        // ç”Ÿæˆæ”¯å‡ºè¡¨æ ¼
        function generateExpenseTable() {
            const table = document.getElementById('expenseTable');
            table.className = 'data-table expense-table'; // æ·»åŠ æ”¯å‡ºä¸“ç”¨æ ·å¼ç±»
            let html = '<thead><tr><th class="row-header">å…¶ä»–è´¹ç”¨</th>';
            
            // æ·»åŠ æœˆä»½åˆ—æ ‡é¢˜
            months.forEach(month => {
                html += `<th>${month}</th>`;
            });
            html += '<th class="total-col">æ€»è®¡</th></tr></thead><tbody>';
            
            // è®¡ç®—æ€»çš„æ€»è®¡ï¼Œç”¨äºéªŒè¯
            let grandTotalCheck = 0;
            
            // æ·»åŠ æ¯ä¸ªæ”¯å‡ºç±»å‹çš„æ•°æ®è¡Œ
            Object.keys(expenseData).forEach(expenseType => {
                // è·³è¿‡æ€»è®¡ä¸º0çš„æ”¯å‡ºç±»å‹
                const typeTotal = expenseData[expenseType].reduce((sum, amount) => sum + amount, 0);
                if (typeTotal === 0) return;
                
                html += `<tr><td class="row-header">${expenseType}</td>`;
                
                months.forEach((month, index) => {
                    const amount = expenseData[expenseType][index];
                    if (amount === 0) {
                        html += `<td>$0.0</td>`;
                    } else {
                        // ä¿æŒåŸå§‹æ­£è´Ÿæ•°ï¼Œä¸å¼ºåˆ¶æ·»åŠ è´Ÿå·
                        html += `<td>$${formatNumber(amount)}</td>`;
                    }
                });
                
                // æ€»è®¡åˆ—
                grandTotalCheck += typeTotal;
                html += `<td class="total-col"><strong>$${formatNumber(typeTotal)}</strong></td></tr>`;
            });
            
            // æ·»åŠ æ€»è®¡è¡Œ
            html += '<tr class="total-row"><td class="row-header"><strong>æœˆåº¦æ€»è®¡</strong></td>';
            let monthlyTotalCheck = 0;
            months.forEach((month, index) => {
                const monthTotal = Object.values(expenseData).reduce((sum, expenseType) => sum + expenseType[index], 0);
                monthlyTotalCheck += monthTotal;
                if (monthTotal === 0) {
                    html += `<td><strong>$0.0</strong></td>`;
                } else {
                    html += `<td><strong>$${formatNumber(monthTotal)}</strong></td>`;
                }
            });
            
            // æ€»çš„æ€»è®¡ - ä½¿ç”¨éªŒè¯è¿‡çš„æ•°å€¼
            html += `<td class="total-col"><strong>$${formatNumber(grandTotalCheck)}</strong></td></tr>`;
            html += '</tbody>';
            
            table.innerHTML = html;
            
            // æ§åˆ¶å°éªŒè¯
            console.log(`æ”¯å‡ºè¡¨æ ¼éªŒè¯: æŒ‰ç±»å‹=${grandTotalCheck.toFixed(2)}, æŒ‰æœˆä»½=${monthlyTotalCheck.toFixed(2)}`);
        }

        // ç”Ÿæˆè´¢åŠ¡æ±‡æ€»è¡¨æ ¼
        function generateFinancialSummaryTable() {
            const table = document.getElementById('financialSummaryTable');
            table.className = 'data-table financial-summary-table';
            let html = '<thead><tr><th class="row-header">æœˆä»½</th>';
            html += '<th>æ”¶å…¥æ€»è®¡</th>';
            html += '<th>æ”¯å‡ºæ€»è®¡</th>';
            html += '<th>å‡€åˆ©æ¶¦</th>';
            html += '<th>åˆ©æ¶¦ç‡</th>';
            html += '</tr></thead><tbody>';
            
            // æ·»åŠ æ¯ä¸ªæœˆçš„æ•°æ®è¡Œ
            months.forEach((month, index) => {
                const income = monthlyFinanceData.income[index];
                const expense = monthlyFinanceData.expenses[index];
                const profit = monthlyFinanceData.profit[index];
                const profitRate = monthlyFinanceData.profitRate[index];
                
                html += `<tr><td class="row-header">${month}</td>`;
                html += `<td class="income-cell">$${formatNumber(income)}</td>`;
                html += `<td class="expense-cell">$${formatNumber(expense)}</td>`;
                
                // å‡€åˆ©æ¶¦æ ¹æ®æ­£è´Ÿæ˜¾ç¤ºä¸åŒé¢œè‰²
                const profitClass = profit >= 0 ? 'positive-profit' : 'negative-profit';
                html += `<td class="${profitClass}">$${formatNumber(profit)}</td>`;
                
                // åˆ©æ¶¦ç‡æ ¹æ®æ­£è´Ÿæ˜¾ç¤ºä¸åŒé¢œè‰²
                const rateClass = profitRate >= 0 ? 'positive-profit' : 'negative-profit';
                html += `<td class="${rateClass}">${profitRate}%</td></tr>`;
            });
            
            // æ·»åŠ æ€»è®¡è¡Œ
            const totalIncome = monthlyFinanceData.income.reduce((sum, val) => sum + val, 0);
            const totalExpense = monthlyFinanceData.expenses.reduce((sum, val) => sum + val, 0);
            const totalProfit = monthlyFinanceData.profit.reduce((sum, val) => sum + val, 0);
            const avgProfitRate = (totalProfit / totalIncome * 100).toFixed(1);
            
            html += '<tr class="total-row">';
            html += '<td class="row-header"><strong>æ€»è®¡</strong></td>';
            html += `<td class="income-cell"><strong>$${formatNumber(totalIncome)}</strong></td>`;
            html += `<td class="expense-cell"><strong>$${formatNumber(totalExpense)}</strong></td>`;
            
            const totalProfitClass = totalProfit >= 0 ? 'positive-profit' : 'negative-profit';
            html += `<td class="${totalProfitClass}"><strong>$${formatNumber(totalProfit)}</strong></td>`;
            
            const totalRateClass = avgProfitRate >= 0 ? 'positive-profit' : 'negative-profit';
            html += `<td class="${totalRateClass}"><strong>${avgProfitRate}%</strong></td></tr>`;
            
            html += '</tbody>';
            table.innerHTML = html;
            
            // æ§åˆ¶å°éªŒè¯
            console.log(`è´¢åŠ¡æ±‡æ€»è¡¨æ ¼: æ€»æ”¶å…¥=${totalIncome}, æ€»æ”¯å‡º=${totalExpense.toFixed(2)}, å‡€åˆ©æ¶¦=${totalProfit.toFixed(2)}`);
        }

        // åˆå§‹åŒ–æ€»è§ˆå›¾è¡¨
        function initOverviewCharts() {
            // æœˆåº¦è´¢åŠ¡å›¾è¡¨
            const financeCtx = document.getElementById('monthlyFinanceChart').getContext('2d');
            monthlyFinanceChart = new Chart(financeCtx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'æ”¶å…¥',
                        data: monthlyFinanceData.income,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'æ”¯å‡º',
                        data: monthlyFinanceData.expenses,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // åˆ©æ¶¦å›¾è¡¨
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            profitChart = new Chart(profitCtx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'å‡€åˆ©æ¶¦',
                        data: monthlyFinanceData.profit,
                        backgroundColor: monthlyFinanceData.profit.map(p => p >= 0 ? 'rgba(16, 185, 129, 0.7)' : 'rgba(239, 68, 68, 0.7)'),
                        borderColor: monthlyFinanceData.profit.map(p => p >= 0 ? '#10b981' : '#ef4444'),
                        borderWidth: 1,
                        yAxisID: 'y'
                    }, {
                        label: 'åˆ©æ¶¦ç‡ (%)',
                        data: monthlyFinanceData.profitRate,
                        type: 'line',
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // å¯¹æ¯”å›¾è¡¨ç›¸å…³å‡½æ•°
        function getSelectedAsins() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        function selectAll() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
            updateComparisonCharts();
        }

        function clearAll() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateComparisonCharts();
        }

        function selectTop3() {
            clearAll();
            ['B0D6X54QJF', 'B0D6ZWNB9B', 'B0DC6WX9WH'].forEach(asin => {
                const checkbox = document.getElementById('asin_' + asin);
                if (checkbox) checkbox.checked = true;
            });
            updateComparisonCharts();
        }

        function initComparisonCharts() {
            if (quantityChart) return; // å·²ç»åˆå§‹åŒ–è¿‡äº†

            const quantityCtx = document.getElementById('quantityChart').getContext('2d');
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            const priceCtx = document.getElementById('priceChart').getContext('2d');
            const distributionCtx = document.getElementById('distributionChart').getContext('2d');

            quantityChart = new Chart(quantityCtx, {
                type: 'line',
                data: { labels: months, datasets: [] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true } },
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            revenueChart = new Chart(revenueCtx, {
                type: 'line',
                data: { labels: months, datasets: [] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: function(value) { return '$' + value.toLocaleString(); } }
                        }
                    },
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            priceChart = new Chart(priceCtx, {
                type: 'line',
                data: { labels: months, datasets: [] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: function(value) { return '$' + value.toFixed(2); } }
                        }
                    },
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            distributionChart = new Chart(distributionCtx, {
                type: 'doughnut',
                data: { labels: [], datasets: [{ data: [], backgroundColor: colors }] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            updateComparisonCharts();
        }

        function updateComparisonCharts() {
            if (!quantityChart) return;

            const selectedAsins = getSelectedAsins();
            
            if (selectedAsins.length === 0) {
                quantityChart.data.datasets = [];
                revenueChart.data.datasets = [];
                priceChart.data.datasets = [];
                distributionChart.data.labels = [];
                distributionChart.data.datasets[0].data = [];
            } else {
                updateLineCharts(selectedAsins);
                updateDistributionChart(selectedAsins);
            }

            quantityChart.update();
            revenueChart.update();
            priceChart.update();
            distributionChart.update();
        }

        function updateLineCharts(selectedAsins) {
            const quantityDatasets = [];
            const revenueDatasets = [];
            const priceDatasets = [];

            selectedAsins.forEach((asin, index) => {
                const data = asinData[asin];
                const color = colors[index % colors.length];

                quantityDatasets.push({
                    label: asin,
                    data: data.quantities,
                    borderColor: color,
                    backgroundColor: color + '20',
                    tension: 0.4,
                    fill: false
                });

                revenueDatasets.push({
                    label: asin,
                    data: data.revenues,
                    borderColor: color,
                    backgroundColor: color + '20',
                    tension: 0.4,
                    fill: false
                });

                const priceData = data.prices.map(price => price === 0 ? null : price);
                priceDatasets.push({
                    label: asin,
                    data: priceData,
                    borderColor: color,
                    backgroundColor: color + '20',
                    tension: 0.4,
                    fill: false,
                    spanGaps: true
                });
            });

            quantityChart.data.datasets = quantityDatasets;
            revenueChart.data.datasets = revenueDatasets;
            priceChart.data.datasets = priceDatasets;
        }

        function updateDistributionChart(selectedAsins) {
            const labels = [];
            const data = [];
            const backgroundColors = [];

            selectedAsins.forEach((asin, index) => {
                const total = asinData[asin].quantities.reduce((sum, qty) => sum + qty, 0);
                if (total > 0) {
                    labels.push(asin);
                    data.push(total);
                    backgroundColors.push(colors[index % colors.length]);
                }
            });

            distributionChart.data.labels = labels;
            distributionChart.data.datasets[0].data = data;
            distributionChart.data.datasets[0].backgroundColor = backgroundColors;
        }

        // æ”¯å‡ºåˆ†æç›¸å…³å‡½æ•°
        function getSelectedExpenseTypes() {
            const checkboxes = document.querySelectorAll('.expense-checkboxes input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        function selectAllExpenses() {
            document.querySelectorAll('.expense-checkboxes input[type="checkbox"]').forEach(cb => cb.checked = true);
            updateExpenseCharts();
        }

        function clearAllExpenses() {
            document.querySelectorAll('.expense-checkboxes input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateExpenseCharts();
        }

        function selectTopExpenses() {
            clearAllExpenses();
            ['Service Fee', 'Refund', 'FBA Inventory Fee'].forEach(type => {
                const checkbox = document.querySelector(`input[value="${type}"]`);
                if (checkbox) checkbox.checked = true;
            });
            updateExpenseCharts();
        }

        function updateExpenseView() {
            const viewType = document.getElementById('expenseViewType').value;
            const titleElement = document.getElementById('expenseChartTitle');
            
            switch(viewType) {
                case 'total':
                    titleElement.textContent = 'æ”¯å‡ºç±»å‹æ€»ä½“å æ¯”';
                    break;
                case 'monthly':
                    titleElement.textContent = 'æ”¯å‡ºç±»å‹æœˆåº¦åˆ†å¸ƒ';
                    break;
                case 'comparison':
                    titleElement.textContent = 'æ”¯å‡ºç±»å‹å¯¹æ¯”åˆ†æ';
                    break;
            }
            
            updateExpenseCharts();
        }

        function initExpenseCharts() {
            if (expenseMainChart) return; // å·²ç»åˆå§‹åŒ–è¿‡äº†

            const mainCtx = document.getElementById('expenseMainChart').getContext('2d');
            const trendCtx = document.getElementById('expenseTrendChart').getContext('2d');

            // ä¸»å›¾è¡¨ - æ ¹æ®è§†å›¾ç±»å‹åŠ¨æ€åˆ‡æ¢
            expenseMainChart = new Chart(mainCtx, {
                type: 'doughnut',
                data: { labels: [], datasets: [{ data: [], backgroundColor: colors }] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((sum, val) => sum + val, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    return `${context.label}: $${context.parsed.toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });

            // è¶‹åŠ¿å›¾è¡¨
            expenseTrendChart = new Chart(trendCtx, {
                type: 'line',
                data: { labels: months, datasets: [] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: false,
                            ticks: { callback: function(value) { return '$' + value.toLocaleString(); } }
                        }
                    },
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            updateExpenseCharts();
        }

        function updateExpenseCharts() {
            if (!expenseMainChart) return;

            const selectedTypes = getSelectedExpenseTypes();
            const viewType = document.getElementById('expenseViewType').value;

            if (selectedTypes.length === 0) {
                expenseMainChart.data.labels = [];
                expenseMainChart.data.datasets[0].data = [];
                expenseTrendChart.data.datasets = [];
            } else {
                updateMainExpenseChart(selectedTypes, viewType);
                updateExpenseTrendChart(selectedTypes);
            }

            expenseMainChart.update();
            expenseTrendChart.update();
        }

        function updateMainExpenseChart(selectedTypes, viewType) {
            const labels = [];
            const data = [];
            const backgroundColors = [];

            if (viewType === 'total') {
                // æ€»ä½“å æ¯”è§†å›¾
                selectedTypes.forEach((type, index) => {
                    const total = expenseData[type].reduce((sum, val) => sum + val, 0);
                    if (total > 0) {
                        labels.push(type);
                        data.push(total);
                        backgroundColors.push(colors[index % colors.length]);
                    }
                });
                expenseMainChart.config.type = 'doughnut';
            } else if (viewType === 'monthly') {
                // æœˆåº¦åˆ†å¸ƒè§†å›¾ - æ˜¾ç¤ºæ¯æœˆæ€»æ”¯å‡º
                months.forEach((month, index) => {
                    const monthTotal = selectedTypes.reduce((sum, type) => sum + expenseData[type][index], 0);
                    labels.push(month);
                    data.push(monthTotal);
                    backgroundColors.push(colors[index % colors.length]);
                });
                expenseMainChart.config.type = 'bar';
            } else if (viewType === 'comparison') {
                // å¯¹æ¯”åˆ†æè§†å›¾
                selectedTypes.forEach((type, index) => {
                    const total = expenseData[type].reduce((sum, val) => sum + val, 0);
                    if (total > 0) {
                        labels.push(type);
                        data.push(total);
                        backgroundColors.push(colors[index % colors.length]);
                    }
                });
                expenseMainChart.config.type = 'bar';
            }

            expenseMainChart.data.labels = labels;
            expenseMainChart.data.datasets[0].data = data;
            expenseMainChart.data.datasets[0].backgroundColor = backgroundColors;
        }

        function updateExpenseTrendChart(selectedTypes) {
            const datasets = [];

            selectedTypes.forEach((type, index) => {
                const color = colors[index % colors.length];
                datasets.push({
                    label: type,
                    data: expenseData[type],
                    borderColor: color,
                    backgroundColor: color + '20',
                    tension: 0.4,
                    fill: false
                });
            });

            expenseTrendChart.data.datasets = datasets;
        }

        function generateDetailedExpenseTable() {
            const table = document.getElementById('detailedExpenseTable');
            table.className = 'data-table expense-table'; // æ·»åŠ æ”¯å‡ºä¸“ç”¨æ ·å¼ç±»
            let html = '<thead><tr><th class="row-header">å…¶ä»–è´¹ç”¨</th>';
            
            // æ·»åŠ æœˆä»½åˆ—æ ‡é¢˜
            months.forEach(month => {
                html += `<th>${month}</th>`;
            });
            html += '<th class="total-col">æ€»è®¡</th><th class="total-col">å æ¯”</th></tr></thead><tbody>';
            
            // è®¡ç®—æ€»æ”¯å‡ºç”¨äºç™¾åˆ†æ¯”è®¡ç®—
            const grandTotal = Object.values(expenseData).reduce((sum, expenseType) => 
                sum + expenseType.reduce((s, amount) => s + amount, 0), 0);
            
            let typeGrandTotal = 0; // ç”¨äºéªŒè¯
            
            // æ·»åŠ æ¯ä¸ªæ”¯å‡ºç±»å‹çš„æ•°æ®è¡Œ
            Object.keys(expenseData).forEach(expenseType => {
                const typeTotal = expenseData[expenseType].reduce((sum, amount) => sum + amount, 0);
                
                // è·³è¿‡æ€»è®¡ä¸º0çš„æ”¯å‡ºç±»å‹
                if (typeTotal === 0) return;
                
                html += `<tr><td class="row-header">${expenseType}</td>`;
                
                months.forEach((month, index) => {
                    const amount = expenseData[expenseType][index];
                    if (amount === 0) {
                        html += `<td>$0.0</td>`;
                    } else {
                        // ä¿æŒåŸå§‹æ­£è´Ÿæ•°ï¼Œä¸å¼ºåˆ¶æ·»åŠ è´Ÿå·
                        html += `<td>$${formatNumber(amount)}</td>`;
                    }
                });
                
                // æ€»è®¡åˆ—å’Œå æ¯”åˆ—
                const percentage = ((Math.abs(typeTotal) / Math.abs(grandTotal)) * 100).toFixed(1);
                typeGrandTotal += typeTotal;
                
                html += `<td class="total-col"><strong>$${formatNumber(typeTotal)}</strong></td>`;
                html += `<td class="total-col"><strong>${percentage}%</strong></td></tr>`;
            });
            
            // æ·»åŠ æ€»è®¡è¡Œ
            html += '<tr class="total-row"><td class="row-header"><strong>æœˆåº¦æ€»è®¡</strong></td>';
            let monthlyGrandTotal = 0; // ç”¨äºéªŒè¯
            months.forEach((month, index) => {
                const monthTotal = Object.values(expenseData).reduce((sum, expenseType) => sum + expenseType[index], 0);
                monthlyGrandTotal += monthTotal;
                if (monthTotal === 0) {
                    html += `<td><strong>$0.0</strong></td>`;
                } else {
                    html += `<td><strong>$${formatNumber(monthTotal)}</strong></td>`;
                }
            });
            
            // æ€»çš„æ€»è®¡
            html += `<td class="total-col"><strong>$${formatNumber(grandTotal)}</strong></td>`;
            html += `<td class="total-col"><strong>100.0%</strong></td></tr>`;
            html += '</tbody>';
            
            table.innerHTML = html;
            
            // æ§åˆ¶å°éªŒè¯
            console.log(`è¯¦ç»†æ”¯å‡ºè¡¨æ ¼éªŒè¯: æ€»è®¡=${grandTotal.toFixed(2)}, æŒ‰ç±»å‹=${typeGrandTotal.toFixed(2)}, æŒ‰æœˆä»½=${monthlyGrandTotal.toFixed(2)}`);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            generateAsinTable();
            generateExpenseTable();
            generateFinancialSummaryTable();
            initOverviewCharts();
            
            // æ·»åŠ å¤é€‰æ¡†äº‹ä»¶ç›‘å¬
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.closest('.expense-checkboxes')) {
                        updateExpenseCharts();
                    } else {
                        updateComparisonCharts();
                    }
                });
            });
        });
    </script>
</body>
</html>
